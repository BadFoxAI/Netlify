<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SimEmoji - Refactored</title>
    <style>
        /* CSS remains largely the same as v3 - Copied here for completeness */
        body { margin: 0; overflow: hidden; background-color: #222; display: flex; font-family: sans-serif; }
        #canvasContainer { flex-grow: 1; position: relative; overflow: hidden; }
        canvas { display: block; background-color: #5a8b5a; cursor: crosshair; image-rendering: pixelated; }
        #uiPanel {
            width: 200px; height: 100vh; background-color: #333; color: #eee;
            padding: 10px; box-sizing: border-box; display: flex; flex-direction: column;
            overflow: hidden; z-index: 10;
        }
        .ui-section { padding-bottom: 10px; border-bottom: 1px solid #555; margin-bottom: 10px; flex-shrink: 0; }
        .ui-section h2, #palette h2 { margin: 0 0 8px 0; font-size: 1.0em; text-align: center; }
        .button-group { display: flex; justify-content: space-around; margin-bottom: 8px; }
        .button-group button, .button-group span {
            background: none; border: 1px solid #777; color: #eee; cursor: pointer;
            font-size: 20px; padding: 4px 8px; border-radius: 4px;
            line-height: 1; user-select: none; flex-grow: 1; margin: 0 2px; text-align: center;
        }
        .button-group button:hover, .button-group span:hover { background-color: #555; }
        .button-group button.active-tool { background-color: #77a; border-color: #99c; }
        .button-group button:disabled { color: #777; cursor: default; background-color: #444; border-color: #555;}
        .button-group span.danger { border-color: #c77; }
        .button-group span.danger:hover { background-color: #a55; }

        #selectedTileDisplay { font-size: 24px; margin-left: 5px; vertical-align: middle; } /* Renamed */
        #coordsDisplay { font-size: 0.8em; color: #aaa; margin-top: 5px; text-align: center; }
        #saveStatus { font-size: 0.8em; color: #8f8; height: 1.2em; margin-top: 4px; text-align: center; }

        #clearConfirm { display: none; font-size: 0.85em; background-color: #444; padding: 5px; border-radius: 3px; margin-top: 5px; text-align: center; }
        #clearConfirm button { font-size: 0.8em; padding: 2px 5px; width: auto; margin: 0 3px; }

        #palette { flex-grow: 1; overflow-y: auto; }
        #palette .tile-category { margin-bottom: 10px; border-bottom: 1px dashed #555; padding-bottom: 5px; } /* Renamed */
        #palette .tile-category h3 { margin: 0 0 3px 0; font-size: 0.9em; color: #bbb; }
        #palette span { /* Style for each tile in the palette */
            display: inline-block; font-size: 22px; padding: 2px; margin: 1px;
            cursor: pointer; border-radius: 3px; border: 1px solid transparent;
            user-select: none; width: 28px; text-align: center; line-height: 1.2;
        }
        #palette span:hover { background-color: #555; }
        #palette span.selected-tile { border: 1px solid #ffff00; background-color: rgba(255, 255, 0, 0.2); } /* Renamed */

        #fileInput { display: none; }
    </style>
</head>
<body>
    <div id="uiPanel">
        <div class="ui-section">
            <h2>SimEmoji</h2>
            <div class="button-group">
                 <button id="buildToolBtn" title="Build Tool (B)">üñåÔ∏è</button>
                 <button id="bulldozeToolBtn" title="Bulldoze Tool (X)">üö´</button> <!-- Changed Icon -->
                 <span style="flex-grow: 0;"> | <span id="selectedTileDisplay">‚ùì</span></span> <!-- Renamed -->
            </div>
             <div class="button-group">
                 <button id="undoBtn" title="Undo (Ctrl+Z)">‚Ü©Ô∏è</button>
                 <button id="redoBtn" title="Redo (Ctrl+Y)">‚Ü™Ô∏è</button>
             </div>
             <div class="button-group">
                 <button id="zoomInBtn" title="Zoom In (+)">‚ûï</button>
                 <button id="zoomOutBtn" title="Zoom Out (-)">‚ûñ</button>
             </div>
             <div class="button-group">
                 <button id="saveFileBtn" title="Save to File">üíæ</button>
                 <button id="loadFileBtn" title="Load from File">üìÇ</button>
                 <span id="clearSaveBtn" class="danger" title="Clear Local Save">‚ùå</span>
             </div>
              <div id="clearConfirm">
                 Are you sure?
                 <button id="clearConfirmYes">Yes</button>
                 <button id="clearConfirmNo">No</button>
             </div>
            <div id="coordsDisplay">Grid: 0,0</div>
            <div id="saveStatus"></div>
        </div>

        <div id="palette">
            <!-- Palette content generated by ui.js -->
            <h2>Palette</h2>
        </div>
    </div>
    <div id="canvasContainer">
        <canvas id="gameCanvas"></canvas>
    </div>
    <input type="file" id="fileInput" accept=".json">

    <!-- Load Scripts as Modules -->
    <script type="module" src="config.js"></script>
    <script type="module" src="state.js"></script>
    <script type="module" src="ui.js"></script>
    <script type="module" src="simemoji.js"></script>
</body>
</html>
